<% user = User.find(@photo.user_id) %>
<% post = @photo.post %>

<div class="post-header">
  <% temp_profile_url = user.profile_photo ? user.profile_photo.pic : "default_profile_pic.jpeg" %>
  <%= image_tag(temp_profile_url, class: "post-header-photo") %>
  <h2><%= "#{user.first_name} #{user.last_name}" %></h2>
</div>

<div class="original-post">
  <div class="post-body">
    <%= post.body %>
    <%= image_tag(post.photos.first.pic, class: "post-photo") %>

    <% if user.id == current_user.id %>

      <% if !user.profile_photo || @photo.id != user.profile_photo.id %>
        <%= button_to "Set this as Profile Pic", photo_url(@photo), method: :put %>
      <% end %>

      <%= button_to "Delete Post", post_url(post), method: :delete %>
    <% end %>

    <% if current_user.friends_ids.include?(user.id) %>
      <%= render "layouts/like_button_post", post: post %>
    <% end %>

    <% if post.likes.count > 0 %>
      <%= pluralize(post.likes.count, "like") %>
    <% end %>
  </div>
</div>

<div class="post-comments">
  <ul>
    <% post.comments.each do |comment| %>
      <li class="list-comment">
        <% commenter = User.find(comment.user_id) %>
        <p>
          <% temp_profile_url = commenter.profile_photo ? commenter.profile_photo.pic : "default_profile_pic.jpeg" %>
          <%= image_tag(temp_profile_url, class: "comment-header-photo") %>
          <%= commenter.first_name + " " + commenter.last_name %>
        </p>
        <%= comment.body %>

        <% if commenter.id == current_user.id %>
          <%= button_to "Delete Comment", comment_url(comment), method: :delete %>
        <% end %>

        <%= render "layouts/like_button_comment", comment: comment %>

        <% if comment.likes.count > 0 %>
          <%= pluralize(comment.likes.count, "like") %>
        <% end %>
      </li>
    <% end %>
  </ul>
</div>

<% if current_user.friends_ids.include?(user.id) %>
  <div class="new-comment">
    <%= render "layouts/comment", post: post %>
  </div>
<% end %>